# 과제 3

### 필수 스펙

- 드래그 앤 드롭(D&D) 기능 개발
  - [x] 캘린더의 일정을 마우스로 끌어 다른 날짜나 시간으로 옮기는 기능을 구현합니다.
- 날짜 클릭으로 일정 생성 기능 개발
  - [x] 캘린더의 비어있는 날짜 셀을 클릭하면, 해당 날짜가 자동으로 폼에 채워지도록 하세요.

## 기본 과제

필수 스펙 개발과 E2E, 시각적 회귀 테스트를 모두 작성해주세요.

### 기본과제 제출

- 아래 작성된 E2E 테스트 작성은 필수입니다. 추가로 작성하고 싶다면 작성해주세요.
- 여기서 말하는 전반은 Create, Read, Update, Delete 모두에 해당합니다.

1. [ ] 기본 일정 관리 워크플로우 전반을 검증하세요.
2. [ ] 반복 일정 관리 워크플로우 전반을 검증하세요.
3. [ ] 일정 겹침 처리 방식에 대해 검증하세요.
4. [ ] 알림 시스템 관련 노출 조건에 대해 검증하세요.
5. [ ] 검색 및 필터링 전반에 대해 검증하세요.

- 아래 시각적 회귀 테스트는 필수 입니다. 추가로 작성하고 싶다면 작성해주세요.

1. [ ] 타입에 따른 캘린더 뷰 렌더링
2. [ ] 일정 상태별 시각적 표현
3. [ ] 다이얼로그 및 모달
4. [ ] 폼 컨트롤 상태
5. [ ] 각 셀 텍스트 길이에 따른 처리

```
♨️
이 과정에서 컴포넌트 리팩토링이 필요할 수 있습니다!
여유가 있다면 컴포넌트를 아름답게 분리하는 고민을 해주시면 좋지만,
당장은 적절한 스토리를 작성하는데 더 집중해주세요.
적절한 추상화, 응집도를 높이고 결합도를 낮추는
우아한 설계는 이후 주차때 좀 더 집중해봐요.
```

```
- 물론, AI를 활용해도 좋습니다.
- 기존에 작성한 테스트는 깨지지 않도록 해주세요.
  - 이 과정에서 테스트가 분리될 수도 작성법이 수정될 수도 있습니다.
  - 정말 불필요한 케이스가 아니면, 테스트 케이스를 삭제하는건 최소화 해주세요.
  - 추가로 필요한 테스트가 생길 수 있지만, 작성은 자유롭게 선택해서 진행해주세요.
```

## 심화 과제

https://github.com/hanghae-plus/front_7th_chapter1-3/pull/47

### 심화 과제 제출

- [x] 내가 생각한 최적의 테스트 전략은 무엇인지, 그리고 그 이유를 작성해주세요.
- [x] 팀원들이 합의한 최적의 테스트 전략은 무엇인지, 그리고 그 이유를 작성해주세요.
- [x] 그 전략에 맞춰 추가한 테스트는 무엇인지 나타내주세요.

---

## 과제 셀프회고

<!-- 과제에 대한 회고를 작성해주세요 -->

### 기술적 성장

- **Playwright e2e 테스트 작성 경험**: EventView의 드래그 앤 드롭 기능에 대한 8개의 포괄적인 e2e 테스트 작성

  - 월간/주간 뷰에서의 일정 이동, 반복 일정 처리, 겹침 검증, 엣지 케이스 등 다양한 시나리오 커버
  - 타임아웃 및 타이밍 이슈 해결을 통해 테스트 안정성 확보 (명시적 대기, timeout 증가)
  - 실제 사용자 인터랙션을 모방한 테스트 작성 방법 학습

- **Storybook 컴포넌트 문서화**: 3개 컴포넌트에 대해 24개 스토리 작성

  - OverlappingEventDialog (6개 스토리), EventSearch (11개 스토리), App (7개 스토리)
  - 다양한 상태(empty, loading, error, 엣지 케이스)를 시각적으로 확인 가능하도록 구성

- **테스트 코드 구조 개선에 대한 사고 확장**

  - 잘 짜인 테스트 코드의 조건(가독성, 명확한 목적, 빠른 엘리먼트 탐색)에 대해 고민함

- **추가 학습 필요 영역**
  - Playwright에서 테스트 간 데이터 분리 자동화 전략 (예: worker 스코프 데이터베이스 초기화)
  - CI/CD 파이프라인에서 캐시, 의존성, 리포팅 구조
  - **e2e 테스트 데이터 안정성 확보 방법**: 테스트 실행 시 기존 데이터와의 충돌, 테스트 간 격리 문제 등으로 인해 테스트가 불안정해지는 상황을 겪었으나, 구체적으로 어느 부분을 어떻게 개선해야 할지 명확한 방향을 잡지 못함.

### 코드 품질

- **테스트 견고성 개선**:

  - e2e 테스트에서 발생하는 타이밍 이슈를 체계적으로 해결하려고 노력함
  - 일정 생성 → 캘린더 렌더링 → 드래그 앤 드롭 각 단계마다 적절한 대기 시간 설정
  - Dialog 차단 문제 해결을 위한 명시적 대기 및 타임아웃 처리

- **스토리북 구성**:

  - MSW를 활용한 API 모킹으로 실제 동작을 스토리북에서 테스트 가능
  - 다양한 엣지 케이스(API 에러, 느린 로딩, 빈 데이터)를 시각적으로 확인 가능
  - 일관된 스토리 작성 패턴 적용

### 학습 효과 분석

- **e2e 테스트의 중요성**:

  - 드래그 앤 드롭 같은 복잡한 사용자 인터랙션은 e2e 테스트가 필수적
  - 타이밍 이슈, 비동기 렌더링 등 실제 환경에서만 발견되는 문제 파악
  - 테스트 안정성을 위한 명시적 대기와 적절한 타임아웃 설정의 중요성 인지

- **문서화의 가치**: Storybook을 통한 컴포넌트 문서화로 개발 과정에서 다양한 상태를 쉽게 확인하고 디버깅 가능

### 과제 피드백

- **좋았던 점**:

  - 오랜만에 테스트 코드가 아닌 기능 구현을 할 수 있었다는 점에서 익숙한 걸 하는 것에 대한 안정감이 잠시나마 있었음

- **개선이 필요했던 부분**:
  - e2e 테스트에서 타이밍 이슈가 많이 발생하여 안정화에 또 시간 소요
  - **테스트 데이터 관리의 어려움**: 테스트 실행 시마다 기존 일정 데이터와의 충돌 발생, 테스트 간 데이터 격리가 되지 않아 테스트 순서에 따라 성공/실패가 달라지는 문제 발생. 근본적인 해결 방법을 찾지 못하고 임시방편으로 타임아웃만 늘리는 방식으로 대응
  - Storybook과 Chromatic을 연동한 UI 테스트 작성에 대해 과제 의도 파악을 하기 힘들었음

## 리뷰 받고 싶은 내용

1. **e2e 테스트 데이터 안정성 확보 방법**:

   - 현재 타임아웃을 늘리고 명시적 대기를 추가하는 방식으로 테스트를 안정화하려 했지만, 근본적인 해결책이 아니라고 느껴집니다
   - 테스트 실행 시마다 기존 데이터와 충돌하거나, 테스트 간 데이터가 격리되지 않아 테스트 순서에 따라 결과가 달라지는 문제를 겪었습니다. **어느 부분(데이터 초기화? fixture 설정? )을 어떻게 개선해야 할지 방향을 잡지 못했습니다**
   - Playwright의 베스트 프랙티스나 프로젝트 구조적으로 개선해야 할 부분이 있을까요?

2. **스토리북 MSW 설정**: 각 스토리마다 handlers를 반복해서 정의하고 있는데, 공통 handlers를 재사용하면서도 스토리별로 커스터마이징할 수 있는 더 효율적인 패턴이 있을까요?
